<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>IPTV - Assistir Canais ao Vivo</title>
    <style>
        :root {
            --primary: #e50914;
            --bg: #141414;
            --bg-light: #1f1f1f;
            --text: #fff;
            --text-secondary: #aaa;
        }
        
        * { margin: 0; padding: 0; box-sizing: border-box; }
        
        body {
            font-family: 'Helvetica Neue', Helvetica, Arial, sans-serif;
            background: var(--bg);
            color: var(--text);
            min-height: 100vh;
        }
        
        /* Header */
        header {
            padding: 20px 4%;
            background: #000;
            display: flex;
            align-items: center;
            justify-content: space-between;
        }
        
        .logo {
            color: var(--primary);
            font-size: 24px;
            font-weight: bold;
        }
        
        /* Player */
        .player-container {
            max-width: 1200px;
            margin: 20px auto;
            padding: 0 20px;
        }
        
        .video-player {
            width: 100%;
            aspect-ratio: 16/9;
            background: #000;
            border-radius: 8px;
            overflow: hidden;
        }
        
        video {
            width: 100%;
            height: 100%;
        }
        
        /* Controls */
        .controls {
            display: flex;
            gap: 10px;
            margin-top: 15px;
            flex-wrap: wrap;
        }
        
        .controls input {
            flex: 1;
            min-width: 300px;
            padding: 12px;
            background: var(--bg-light);
            border: 1px solid #333;
            border-radius: 4px;
            color: var(--text);
            font-size: 14px;
        }
        
        .controls button {
            padding: 12px 24px;
            background: var(--primary);
            border: none;
            border-radius: 4px;
            color: #fff;
            font-weight: bold;
            cursor: pointer;
        }
        
        .controls button:hover {
            background: #b20710;
        }
        
        /* Load M3U */
        .load-m3u {
            max-width: 1200px;
            margin: 20px auto;
            padding: 20px;
            background: var(--bg-light);
            border-radius: 8px;
        }
        
        .load-m3u h2 {
            margin-bottom: 15px;
        }
        
        .m3u-input {
            width: 100%;
            padding: 15px;
            background: #000;
            border: 1px solid #333;
            border-radius: 4px;
            color: var(--text);
            font-family: monospace;
            min-height: 150px;
            margin-bottom: 15px;
        }
        
        /* Channels Grid */
        .channels-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(200px, 1fr));
            gap: 15px;
            max-width: 1200px;
            margin: 20px auto;
            padding: 0 20px;
        }
        
        .channel-card {
            background: var(--bg-light);
            border-radius: 8px;
            overflow: hidden;
            cursor: pointer;
            transition: transform 0.3s;
        }
        
        .channel-card:hover {
            transform: scale(1.05);
        }
        
        .channel-thumb {
            width: 100%;
            height: 120px;
            background: #333;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 40px;
        }
        
        .channel-info {
            padding: 12px;
        }
        
        .channel-name {
            font-weight: bold;
            margin-bottom: 5px;
        }
        
        .channel-category {
            font-size: 12px;
            color: var(--text-secondary);
        }
        
        /* Tabs */
        .tabs {
            display: flex;
            gap: 10px;
            max-width: 1200px;
            margin: 20px auto;
            padding: 0 20px;
        }
        
        .tab {
            padding: 12px 24px;
            background: var(--bg-light);
            border: none;
            border-radius: 4px;
            color: var(--text);
            cursor: pointer;
        }
        
        .tab.active {
            background: var(--primary);
        }
        
        /* Categories */
        .categories {
            display: flex;
            gap: 10px;
            flex-wrap: wrap;
            max-width: 1200px;
            margin: 15px auto;
            padding: 0 20px;
        }
        
        .category {
            padding: 8px 16px;
            background: var(--bg-light);
            border: none;
            border-radius: 20px;
            color: var(--text);
            cursor: pointer;
            font-size: 14px;
        }
        
        .category.active {
            background: var(--primary);
        }
        
        /* Loading */
        .loading {
            text-align: center;
            padding: 40px;
            color: var(--text-secondary);
        }
        
        /* Error */
        .error {
            background: #ff4444;
            color: #fff;
            padding: 15px;
            border-radius: 4px;
            margin: 20px auto;
            max-width: 1200px;
        }
        
        /* Info */
        .info-box {
            background: #333;
            padding: 15px;
            border-radius: 4px;
            margin: 15px 20px;
            max-width: 1160px;
        }
        
        @media (max-width: 768px) {
            .controls input {
                min-width: 100%;
            }
            .channels-grid {
                grid-template-columns: repeat(2, 1fr);
            }
        }
    </style>
</head>
<body>
    <header>
        <div class="logo">ðŸ“º IPTV</div>
    </header>

    <!-- Player -->
    <div class="player-container">
        <div class="video-player">
            <video id="videoPlayer" controls>
                <source src="" type="application/x-mpegURL">
                Seu navegador nÃ£o suporta reproduÃ§Ã£o de vÃ­deo.
            </video>
        </div>
        <div class="controls">
            <input type="text" id="m3uUrl" placeholder="Cole a URL da lista M3U aqui...">
            <button onclick="loadM3U()">Carregar Lista</button>
            <button onclick="loadDemo()">Carregar Demo</button>
        </div>
    </div>

    <!-- Info -->
    <div">
        <strong class="info-box>ðŸ“º Como usar:</strong><br>
        1. Cole uma URL de lista M3U (IPTV) acima<br>
        2. Clique em "Carregar Lista"<br>
        3. Escolha um canal para assistir<br>
        4. Use o player para controlar (play, pause, volume)
    </div>

    <!-- Tabs -->
    <div class="tabs">
        <button class="tab active" onclick="showTab('all')">Todos</button>
        <button class="tab" onclick="showTab('TV')">TV Aberta</button>
        <button class="tab" onclick="showTab('Movies')">Filmes</button>
        <button class="tab" onclick="showTab('Series')">SÃ©ries</button>
        <button class="tab" onclick="showTab('Adult')">Adultos</button>
    </div>

    <!-- Categories -->
    <div class="categories" id="categories">
        <!-- Categories will be added dynamically -->
    </div>

    <!-- Channels -->
    <div class="channels-grid" id="channels">
        <div class="loading">
            Carregue uma lista M3U ou clique em "Carregar Demo" para testar!
        </div>
    </div>

    <script>
        let channels = [];
        let currentCategory = 'all';

        // Parse M3U
        function parseM3U(content) {
            const lines = content.split('\n');
            const channels = [];
            let channel = {};

            for (let line of lines) {
                line = line.trim();
                
                if (line.startsWith('#EXTINF:')) {
                    // Parse metadata
                    const match = line.match(/#EXTINF:([^,]*),(.*)/);
                    if (match) {
                        channel = {
                            duration: match[1],
                            name: match[2].trim()
                        };
                        
                        // Parse group
                        const groupMatch = line.match(/group-title="([^"]*)"/);
                        if (groupMatch) {
                            channel.category = groupMatch[1];
                        }
                        
                        // Parse logo
                        const logoMatch = line.match(/tvg-logo="([^"]*)"/);
                        if (logoMatch) {
                            channel.logo = logoMatch[1];
                        }
                    }
                } else if (line && !line.startsWith('#')) {
                    channel.url = line;
                    
                    if (channel.name && channel.url) {
                        channels.push(channel);
                    }
                    channel = {};
                }
            }

            return channels;
        }

        // Load M3U from URL
        async function loadM3U() {
            const url = document.getElementById('m3uUrl').value.trim();
            
            if (!url) {
                alert('Cole uma URL de lista M3U primeiro!');
                return;
            }

            try {
                const response = await fetch(url);
                const content = await response.text();
                channels = parseM3U(content);
                renderChannels();
                renderCategories();
            } catch (error) {
                alert('Erro ao carregar lista: ' + error.message);
            }
        }

        // Load demo channels
        function loadDemo() {
            const demoContent = `#EXTM3U
#EXTINF:-1 tvg-logo="https://encrypted-tbn0.gstatic.com/images?q=tbn:ANd9GcQCzSqH-9HdV4eH6R0Q3z6Y" group-title="TV Aberta",Globo
https://stream.hls01.hostingtvbrasil.com/live/8f6b778fos85yu/master.m3u8
#EXTINF:-1 tvg-logo="https://encrypted-tbn0.gstatic.com/images?q=tbn:ANd9GcS5XvJj7KjK9pV3Y2Q1w" group-title="TV Aberta",SBT
https://stream.hls01.hostingtvbrasil.com/live/sbt/master.m3u8
#EXTINF:-1 tvg-logo="https://encrypted-tbn0.gstatic.com/images?q=tbn:ANd9GcQ0fVxU5Xc7Y" group-title="TV Aberta",Record
https://stream.hls01.hostingtvbrasil.com/live/record/master.m3u8
#EXTINF:-1 tvg-logo="https://encrypted-tbn0.gstatic.com/images?q=tbn:ANd9GcR1xT3Y5kH8" group-title="Movies",Netflix (Demo)
https://commondatastorage.googleapis.com/gtv-videos-bucket/sample/BigBuckBunny.mp4
#EXTINF:-1 tvg-logo="https://encrypted-tbn0.gstatic.com/images?q=tbn:ANd9GcP2vT1XaN9w" group-title="Movies",Filme de AÃ§Ã£o
https://commondatastorage.googleapis.com/gtv-videos-bucket/sample/ElephantsDream.mp4
#EXTINF:-1 tvg-logo="https://encrypted-tbn0.gstatic.com/images?q=tbn:ANd9GcT5YfX1mL8pK" group-title="Series",SÃ©rie Demo
https://commondatastorage.googleapis.com/gtv-videos-bucket/sample/ForBiggerBlazes.mp4`;

            channels = parseM3U(demoContent);
            renderChannels();
            renderCategories();
            alert('Demo carregado! Clique em um canal para assistir.');
        }

        // Render channels
        function renderChannels() {
            const container = document.getElementById('channels');
            
            let filtered = channels;
            if (currentCategory !== 'all') {
                filtered = channels.filter(ch => {
                    if (currentCategory === 'TV') return ch.category && (ch.category.includes('TV') || ch.category.includes('Aberta'));
                    if (currentCategory === 'Movies') return ch.category && (ch.category.includes('Movie') || ch.category.includes('Filme'));
                    if (currentCategory === 'Series') return ch.category && (ch.category.includes('Series') || ch.category.includes('SÃ©rie'));
                    if (currentCategory === 'Adult') return ch.category && (ch.category.includes('Adult') || ch.category.includes('XXX'));
                    return true;
                });
            }

            if (filtered.length === 0) {
                container.innerHTML = '<div class="loading">Nenhum canal encontrado nesta categoria.</div>';
                return;
            }

            container.innerHTML = filtered.map((channel, index) => `
                <div class="channel-card" onclick="playChannel(${index})">
                    <div class="channel-thumb">
                        ${channel.logo ? `<img src="${channel.logo}" style="width:100%;height:100%;object-fit:cover;">` : 'ðŸ“º'}
                    </div>
                    <div class="channel-info">
                        <div class="channel-name">${channel.name}</div>
                        <div class="channel-category">${channel.category || 'Sem categoria'}</div>
                    </div>
                </div>
            `).join('');
        }

        // Render categories
        function renderCategories() {
            const categories = new Set();
            channels.forEach(ch => {
                if (ch.category) categories.add(ch.category);
            });

            const container = document.getElementById('categories');
            let html = '<button class="category active" onclick="filterCategory(\'all\')">Todos</button>';
            
            categories.forEach(cat => {
                html += `<button class="category" onclick="filterCategory('${cat}')">${cat}</button>`;
            });

            container.innerHTML = html;
        }

        // Filter category
        function filterCategory(category) {
            document.querySelectorAll('.category').forEach(btn => btn.classList.remove('active'));
            event.target.classList.add('active');
            
            const container = document.getElementById('channels');
            let filtered = channels;
            
            if (category !== 'all') {
                filtered = channels.filter(ch => ch.category === category);
            }

            if (filtered.length === 0) {
                container.innerHTML = '<div class="loading">Nenhum canal encontrado.</div>';
                return;
            }

            container.innerHTML = filtered.map((channel, index) => `
                <div class="channel-card" onclick="playChannel(${channels.indexOf(channel)})">
                    <div class="channel-thumb">
                        ${channel.logo ? `<img src="${channel.logo}" style="width:100%;height:100%;object-fit:cover;">` : 'ðŸ“º'}
                    </div>
                    <div class="channel-info">
                        <div class="channel-name">${channel.name}</div>
                        <div class="channel-category">${channel.category || 'Sem categoria'}</div>
                    </div>
                </div>
            `).join('');
        }

        // Show tab
        function showTab(tab) {
            currentCategory = tab;
            document.querySelectorAll('.tab').forEach(btn => btn.classList.remove('active'));
            event.target.classList.add('active');
            renderChannels();
        }

        // Play channel
        function playChannel(index) {
            const channel = channels[index];
            const player = document.getElementById('videoPlayer');
            
            player.src = channel.url;
            player.play();
            
            // Scroll to player
            player.scrollIntoView({ behavior: 'smooth' });
        }

        // Keyboard shortcuts
        document.addEventListener('keydown', (e) => {
            const player = document.getElementById('videoPlayer');
            
            if (e.code === 'Space') {
                e.preventDefault();
                if (player.paused) player.play();
                else player.pause();
            }
            else if (e.code === 'ArrowUp') {
                player.volume = Math.min(1, player.volume + 0.1);
            }
            else if (e.code === 'ArrowDown') {
                player.volume = Math.max(0, player.volume - 0.1);
            }
            else if (e.code === 'ArrowLeft') {
                player.currentTime = Math.max(0, player.currentTime - 10);
            }
            else if (e.code === 'ArrowRight') {
                player.currentTime = Math.min(player.duration, player.currentTime + 10);
            }
            else if (e.code === 'KeyF') {
                if (player.requestFullscreen) player.requestFullscreen();
            }
            else if (e.code === 'KeyM') {
                player.muted = !player.muted;
            }
        });
    </script>
</body>
</html>
