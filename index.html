<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>IPTV - Canais ao Vivo</title>
    <style>
        :root { --primary: #e50914; --bg: #141414; --bg-light: #1f1f1f; --text: #fff; --text-secondary: #aaa; }
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body { font-family: 'Helvetica Neue', Arial, sans-serif; background: var(--bg); color: var(--text); min-height: 100vh; }
        
        /* Header */
        header { position: fixed; top: 0; width: 100%; padding: 15px 4%; background: linear-gradient(to bottom, rgba(0,0,0,0.9), transparent); display: flex; justify-content: space-between; align-items: center; z-index: 100; }
        header.scrolled { background: #000; }
        .logo { color: var(--primary); font-size: 24px; font-weight: bold; }
        
        /* Hero */
        .hero { height: 50vh; background: linear-gradient(to top, var(--bg), transparent), url('https://image.tmdb.org/t/p/original/p1F51Lvj3sMopG948F5HsBbl43C.jpg'); background-size: cover; display: flex; align-items: center; padding: 80px 4% 0; }
        .hero h1 { font-size: 40px; margin-bottom: 10px; }
        
        /* Search */
        .search-box { padding: 15px 4%; }
        .search-box input { width: 100%; padding: 14px; background: #333; border: none; border-radius: 4px; color: white; font-size: 15px; }
        
        /* Categories */
        .categories { display: flex; gap: 10px; padding: 10px 4%; overflow-x: auto; }
        .category { padding: 8px 16px; background: var(--bg-light); border: none; border-radius: 20px; color: var(--text); cursor: pointer; white-space: nowrap; }
        .category.active { background: var(--primary); }
        
        /* Channels */
        .section { padding: 15px 0; }
        .section-title { font-size: 18px; font-weight: bold; margin-bottom: 12px; padding: 0 4%; }
        .channels-scroll { display: flex; overflow-x: auto; padding: 10px 4%; gap: 12px; }
        .channels-scroll::-webkit-scrollbar { display: none; }
        
        .channel-card { min-width: 160px; background: var(--bg-light); border-radius: 6px; overflow: hidden; cursor: pointer; transition: transform 0.3s; }
        .channel-card:hover { transform: scale(1.05); }
        .channel-thumb { width: 100%; height: 90px; background: #333; display: flex; align-items: center; justify-content: center; font-size: 30px; position: relative; }
        .channel-thumb img { width: 100%; height: 100%; object-fit: cover; }
        .live-badge { position: absolute; top: 5px; right: 5px; background: red; padding: 2px 6px; border-radius: 3px; font-size: 9px; font-weight: bold; }
        .channel-info { padding: 10px; }
        .channel-name { font-weight: bold; font-size: 13px; white-space: nowrap; overflow: hidden; text-overflow: ellipsis; }
        .channel-category { font-size: 11px; color: var(--text-secondary); margin-top: 3px; }
        
        /* Player */
        #playerModal { display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: #000; z-index: 200; flex-direction: column; }
        #playerModal.show { display: flex; }
        .player-header { padding: 15px; display: flex; justify-content: space-between; align-items: center; }
        .close-player { background: none; border: none; color: white; font-size: 24px; cursor: pointer; }
        .video-wrapper { flex: 1; display: flex; align-items: center; justify-content: center; }
        video { width: 100%; height: 100%; max-height: 70vh; }
        .player-controls { padding: 15px; background: rgba(0,0,0,0.8); }
        .player-controls input { width: 100%; padding: 12px; background: #333; border: none; border-radius: 4px; color: white; margin-bottom: 10px; }
        .player-controls button { padding: 10px 20px; background: var(--primary); border: none; border-radius: 4px; color: white; cursor: pointer; margin-right: 10px; }
        
        /* Loading */
        .loading { text-align: center; padding: 30px; color: var(--text-secondary); }
        
        /* Login */
        #loginScreen { position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: linear-gradient(rgba(0,0,0,0.8), rgba(0,0,0,0.9)), url('https://image.tmdb.org/t/p/original/p1F51Lvj3sMopG948F5HsBbl43C.jpg'); background-size: cover; display: flex; align-items: center; justify-content: center; z-index: 1000; }
        .login-box { background: rgba(0,0,0,0.85); padding: 40px; border-radius: 8px; width: 90%; max-width: 350px; }
        .login-title { color: var(--primary); font-size: 32px; text-align: center; margin-bottom: 25px; }
        .login-form input { width: 100%; padding: 14px; margin-bottom: 15px; background: #333; border: none; border-radius: 4px; color: #fff; font-size: 15px; }
        .login-btn { width: 100%; padding: 14px; background: var(--primary); border: none; border-radius: 4px; color: #fff; font-size: 15px; font-weight: bold; cursor: pointer; }
        
        /* App */
        #app { display: none; }
        
        footer { padding: 30px; text-align: center; color: var(--text-secondary); font-size: 12px; }
        
        @media (max-width: 768px) { .hero h1 { font-size: 26px; } .channel-card { min-width: 130px; } }
    </style>
</head>
<body>
    <!-- Login -->
    <div id="loginScreen">
        <div class="login-box">
            <h1 class="login-title">ðŸ“º IPTV</h1>
            <form class="login-form" onsubmit="login(event)">
                <input type="text" id="username" placeholder="UsuÃ¡rio" required>
                <input type="password" id="password" placeholder="Senha" required>
                <button type="submit" class="login-btn">Entrar</button>
            </form>
            <p style="text-align: center; color: #666; font-size: 12px; margin-top: 15px;">admin / admin123</p>
        </div>
    </div>

    <!-- App -->
    <div id="app">
        <header id="header">
            <div class="logo">ðŸ“º IPTV</div>
        </header>

        <div class="hero">
            <h1>IPTV Premium</h1>
        </div>

        <div class="search-box">
            <input type="text" id="searchInput" placeholder="Buscar canal..." oninput="searchChannels()">
        </div>

        <div class="categories" id="categories">
            <button class="category active" onclick="filterCategory('all')">Todos</button>
        </div>

        <section class="section">
            <h2 class="section-title">ðŸ“¡ Canais ao Vivo</h2>
            <div class="channels-scroll" id="liveSection"><div class="loading">Carregando...</div></div>
        </section>

        <section class="section">
            <h2 class="section-title">ðŸŽ¬ Filmes</h2>
            <div class="channels-scroll" id="moviesSection"><div class="loading">Carregando...</div></div>
        </section>

        <section class="section">
            <h2 class="section-title">ðŸ“º SÃ©ries</h2>
            <div class="channels-scroll" id="seriesSection"><div class="loading">Carregando...</div></div>
        </section>

        <section class="section">
            <h2 class="section-title">ðŸ“‹ Todos os Canais</h2>
            <div class="channels-scroll" id="allSection"><div class="loading">Carregando...</div></div>
        </section>

        <footer>
            <p>Â© 2026 IPTV Premium - Todos os canais carregados da sua lista!</p>
        </footer>
    </div>

    <!-- Player -->
    <div id="playerModal">
        <div class="player-header">
            <h3 id="playerTitle">Canal</h3>
            <button class="close-player" onclick="closePlayer()">âœ•</button>
        </div>
        <div class="video-wrapper">
            <video id="videoPlayer" controls></video>
        </div>
        <div class="player-controls">
            <input type="text" id="channelUrl" placeholder="URL do stream">
            <button onclick="loadChannel()">Carregar</button>
            <button onclick="closePlayer()">Fechar</button>
        </div>
    </div>

    <script>
        // API Base URL - Configure seu servidor aqui
        const API_URL = 'https://iptv-server-production.up.railway.app';
        
        // Alternativas (se nÃ£o tiver servidor):
        // const API_URL = ''; // Vazio = usa demo
        
        let allChannels = [];
        let categories = [];

        // Login
        function login(e) {
            e.preventDefault();
            const u = document.getElementById('username').value;
            const p = document.getElementById('password').value;
            
            if ((u === 'admin' && p === 'admin123') || (u === 'user' && p === 'user123')) {
                document.getElementById('loginScreen').style.display = 'none';
                document.getElementById('app').style.display = 'block';
                loadChannels();
            } else {
                alert('Login incorreto!');
            }
        }

        // Load channels from API
        async function loadChannels() {
            showLoading('Carregando canais da lista M3U...');
            
            try {
                // Tenta buscar do servidor
                if (API_URL) {
                    const response = await fetch(`${API_URL}/channels`);
                    const data = await response.json();
                    allChannels = data.channels || [];
                }
                
                // Se nÃ£o conseguiu, usa lista hardcoded com URLs diretas
                if (allChannels.length === 0) {
                    allChannels = getHardcodedChannels();
                }
                
                renderCategories();
                renderChannels();
                
            } catch (error) {
                console.error('Erro:', error);
                allChannels = getHardcodedChannels();
                renderCategories();
                renderChannels();
            }
        }

        // Canais hardcoded (fallback)
        function getHardcodedChannels() {
            return [
                { name: "Globo HD", category: "TV Aberta", logo: "https://logodownload.org/globo-logo-0.png", url: "https://stream.hls01.hostingtvbrasil.com/live/8f6b778fos85yu/master.m3u8" },
                { name: "SBT", category: "TV Aberta", logo: "https://logodownload.org/sbt-logo-1.png", url: "https://stream.hls01.hostingtvbrasil.com/live/sbt/master.m3u8" },
                { name: "Record TV", category: "TV Aberta", logo: "https://logodownload.org/record-logo-0.png", url: "https://stream.hls01.hostingtvbrasil.com/live/record/master.m3u8" },
                { name: "Band", category: "TV Aberta", logo: "https://logodownload.org/band-logo-0.png", url: "https://stream.hls01.hostingtvbrasil.com/live/band/master.m3u8" },
                { name: "RedeTV", category: "TV Aberta", logo: "https://logodownload.org/redetv-logo-0.png", url: "https://stream.hls01.hostingtvbrasil.com/live/redetv/master.m3u8" },
                { name: "TV Brasil", category: "TV Aberta", logo: "https://logodownload.org/tv-brasil-logo-0.png", url: "https://stream.hls01.hostingtvbrasil.com/live/tvbrasil/master.m3u8" },
                { name: "Cultura", category: "TV Aberta", logo: "https://logodownload.org/tv-cultura-logo-0.png", url: "https://stream.hls01.hostingtvbrasil.com/live/cultura/master.m3u8" },
                { name: "GloboNews", category: "NotÃ­cias", logo: "https://logodownload.org/globo-news-logo-0.png", url: "https://stream.hls01.hostingtvbrasil.com/live/globonews/master.m3u8" },
                { name: "BandNews", category: "NotÃ­cias", logo: "https://logodownload.org/bandnews-logo-0.png", url: "https://stream.hls01.hostingtvbrasil.com/live/bandnews/master.m3u8" },
                { name: "CNN Brasil", category: "NotÃ­cias", logo: "https://logodownload.org/cnn-brasil-logo-0.png", url: "https://stream.hls01.hostingtvbrasil.com/live/cnn/master.m3u8" },
                { name: "Netflix Demo", category: "Filmes", logo: "https://upload.wikimedia.org/wikipedia/commons/0/08/Netflix_2015_logo.svg", url: "https://commondatastorage.googleapis.com/gtv-videos-bucket/sample/BigBuckBunny.mp4" },
                { name: "Filme AÃ§Ã£o", category: "Filmes", logo: "https://logodownload.org/netflix-logo-0.png", url: "https://commondatastorage.googleapis.com/gtv-videos-bucket/sample/ElephantsDream.mp4" },
                { name: "Filme ComÃ©dia", category: "Filmes", logo: "https://logodownload.org/netflix-logo-0.png", url: "https://commondatastorage.googleapis.com/gtv-videos-bucket/sample/ForBiggerBlazes.mp4" },
                { name: "Filme Terror", category: "Filmes", logo: "https://logodownload.org/netflix-logo-0.png", url: "https://commondatastorage.googleapis.com/gtv-videos-bucket/sample/ForBiggerEscapes.mp4" },
                { name: "SÃ©rie Drama", category: "SÃ©ries", logo: "https://logodownload.org/hbo-logo-0.png", url: "https://commondatastorage.googleapis.com/gtv-videos-bucket/sample/ForBiggerFun.mp4" },
                { name: "HBO HD", category: "SÃ©ries", logo: "https://logodownload.org/hbo-logo-0.png", url: "https://commondatastorage.googleapis.com/gtv-videos-bucket/sample/ForBiggerJoyrides.mp4" },
                { name: "ESPN", category: "Esportes", logo: "https://logodownload.org/espn-logo-0.png", url: "https://stream.hls01.hostingtvbrasil.com/live/espn/master.m3u8" },
                { name: "Fox Sports", category: "Esportes", logo: "https://logodownload.org/fox-sports-logo-0.png", url: "https://stream.hls01.hostingtvbrasil.com/live/foxsports/master.m3u8" },
                { name: "Premiere", category: "Esportes", logo: "https://logodownload.org/premiere-fc-logo-0.png", url: "https://stream.hls01.hostingtvbrasil.com/live/premiere/master.m3u8" },
                { name Liga", category: "Esportes", logo: "https://logodownload: "Primeira.org/brasileirao-serie-a-logo-0.png", url: "https://stream.hls01.hostingtvbrasil.com/live/brasileirao/master.m3u8" }
            ];
        }

        // Render categories
        function renderCategories() {
            const cats = new Set();
            allChannels.forEach(c => { if (c.category) cats.add(c.category); });
            
            categories = ['all', 'TV Aberta', 'NotÃ­cias', 'Filmes', 'SÃ©ries', 'Esportes', ...Array.from(cats)];
            
            let html = categories.slice(0, 8).map(cat => 
                `<button class="category ${cat === 'all' ? 'active' : ''}" onclick="filterCategory('${cat}')">${cat === 'all' ? 'Todos' : cat}</button>`
            ).join('');
            
            document.getElementById('categories').innerHTML = html;
        }

        // Render channels
        function renderChannels() {
            const live = allChannels.filter(c => !c.category || c.category.includes('TV') || c.category.includes('Aberta') || c.category.includes('News'));
            const movies = allChannels.filter(c => c.category && (c.category.includes('Movie') || c.category.includes('Filme') || c.category.includes('Cinema')));
            const series = allChannels.filter(c => c.category && (c.category.includes('Series') || c.category.includes('SÃ©rie')));
            
            document.getElementById('liveSection').innerHTML = live.length ? live.map(c => createCard(c)).join('') : '<div class="loading">Nenhum canal</div>';
            document.getElementById('moviesSection').innerHTML = movies.length ? movies.map(c => createCard(c)).join('') : '<div class="loading">Nenhum filme</div>';
            document.getElementById('seriesSection').innerHTML = series.length ? series.map(c => createCard(c)).join('') : '<div class="loading">Nenhuma sÃ©rie</div>';
            document.getElementById('allSection').innerHTML = allChannels.slice(0, 25).map(c => createCard(c)).join('');
        }

        function createCard(channel) {
            return `
                <div class="channel-card" onclick="playChannel('${encodeURIComponent(channel.url)}', '${encodeURIComponent(channel.name)}')">
                    <div class="channel-thumb">
                        ${channel.logo ? `<img src="${channel.logo}" onerror="this.parentElement.innerHTML='ðŸ“º'">` : 'ðŸ“º'}
                        <span class="live-badge">AO VIVO</span>
                    </div>
                    <div class="channel-info">
                        <div class="channel-name">${channel.name}</div>
                        <div class="channel-category">${channel.category || 'TV'}</div>
                    </div>
                </div>
            `;
        }

        // Filter
        function filterCategory(cat) {
            document.querySelectorAll('.category').forEach(b => b.classList.remove('active'));
            event.target.classList.add('active');
            
            if (cat === 'all') {
                renderChannels();
            } else {
                const filtered = allChannels.filter(c => c.category && c.category.includes(cat));
                document.getElementById('allSection').innerHTML = filtered.slice(0, 25).map(c => createCard(c)).join('');
            }
        }

        // Search
        function searchChannels() {
            const query = document.getElementById('searchInput').value.toLowerCase();
            if (!query) { renderChannels(); return; }
            
            const filtered = allChannels.filter(c => c.name.toLowerCase().includes(query));
            document.getElementById('allSection').innerHTML = filtered.slice(0, 25).map(c => createCard(c)).join('');
        }

        // Play
        function playChannel(url, name) {
            document.getElementById('playerTitle').textContent = decodeURIComponent(name);
            document.getElementById('channelUrl').value = decodeURIComponent(url);
            document.getElementById('playerModal').classList.add('show');
            
            const player = document.getElementById('videoPlayer');
            player.src = decodeURIComponent(url);
            player.play();
        }

        function loadChannel() {
            const url = document.getElementById('channelUrl').value;
            const player = document.getElementById('videoPlayer');
            player.src = url;
            player.play();
        }

        function closePlayer() {
            const player = document.getElementById('videoPlayer');
            player.pause();
            player.src = '';
            document.getElementById('playerModal').classList.remove('show');
        }

        function showLoading(msg) {
            document.getElementById('liveSection').innerHTML = `<div class="loading">${msg}</div>`;
            document.getElementById('moviesSection').innerHTML = `<div class="loading">${msg}</div>`;
            document.getElementById('seriesSection').innerHTML = `<div class="loading">${msg}</div>`;
        }

        // Header scroll
        window.addEventListener('scroll', () => {
            document.getElementById('header').classList.toggle('scrolled', window.scrollY > 50);
        });
    </script>
</body>
</html>
